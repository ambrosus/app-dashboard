<!--
Copyright: Ambrosus Technologies GmbH
Email: tech@ambrosus.com
This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
This Source Code Form is “Incompatible With Secondary Licenses”, as defined by the Mozilla Public License, v. 2.0.
-->
<div class="m-b-20 flex flex-direction-r justify-content-fe align-items-c">
  <app-svg-icon name="search" width="15" height="15" fill="#4a4a4a" (click)="showSearch = !showSearch"></app-svg-icon>
</div>

<div class="search m-b-20" *ngIf="showSearch">
  <select id="select">
    <option value="type" selected>type</option>
  </select>
  <input type="text" id="search" placeholder="{{ searchPlaceholder }}">
  <a class="abtn btn-solid-ablue" (click)="loadEvents(0, true)">Search</a>
</div>

<div class="events">
  <div class="event" *ngFor="let event of events" [routerLink]="'/assets/' + assetId + '/events/' + event.eventId">
    <p>
      <span style="color: #4f77f1;">{{ event.type || '' }}</span> {{ event.name || event.type }}
      <span class="event__location" *ngIf="event.location">{{ event.location.city || event.city || '' }}, {{ event.location.country || event.country || event.location.name }}
      </span>
    </p>
    <p class="right">{{ event.timestamp * 1000 | date:'d MMM yyyy HH:mm' }} ({{ event.timestamp }})</p>
  </div>
</div>

<div class="block-center m-w-12 m-v-10 p-h-10">
  <div *ngIf="!searchActive && events.length > 0">
    Showing {{ (currentEventsPage - 1) * perPage + 1 }} to
    <span *ngIf="currentEventsPage * perPage > resultCountEvents">{{ resultCountEvents }}</span>
    <span *ngIf="currentEventsPage * perPage <= resultCountEvents">{{ currentEventsPage * perPage }}</span> of {{ resultCountEvents }} events
  </div>
  <div *ngIf="searchActive && events.length > 0">
    Showing {{ (currentSearchPage - 1) * perPage + 1 }} to
    <span *ngIf="currentSearchPage * perPage > resultCountSearch">{{ resultCountSearch }}</span>
    <span *ngIf="currentSearchPage * perPage <= resultCountSearch">{{ currentSearchPage * perPage }}</span> of {{ resultCountSearch }} events
  </div>
</div>

<!-- Pagination -->
<div class="block-center m-w-12 m-t-10 p-h-10">
  <!-- Asset pagination -->
  <app-pagination *ngIf="!searchActive" [currentPage]="currentEventsPage" [totalPages]="totalEventsPages" [method]="loadEvents"></app-pagination>
  <!-- Search pagination -->
  <app-pagination *ngIf="searchActive" [currentPage]="currentSearchPage" [totalPages]="totalSearchPages" [method]="search"></app-pagination>
</div>
